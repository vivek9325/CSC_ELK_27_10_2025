   81  curl -X GET "http://127.0.0.1:9200/_cat/indices?v"
   82  curl -X GET "http://127.0.0.1:9200/movies"
   83  curl -X GET "http://127.0.0.1:9200/movies/_mapping?pretty"
   84  curl -X GET "http://127.0.0.1:9200/movies/_mapping"
   85  curl -X GET "http://127.0.0.1:9200/movies/_mapping?pretty"

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Index Creation -----

curl -X PUT "http://localhost:9200/vk_movies" -H 'Content-Type: application/json' -d'
{ "settings": {  "number_of_shards": 1, "number_of_replicas": 1 },  "mappings": { 
    "properties": {"title": { "type": "text" },"genre": { "type": "keyword" },"year": { "type": "integer" }}}}' 


ubuntu@ip-172-31-23-72:~$ curl -X POST "http://127.0.0.1:9200/vk_movie/_doc/1" -H 'Content-type:application/json' -d '{"title" : "Titanic", "genre" : "adventure", "year" : 2001}'
{"_index":"vk_movie","_id":"1","_version":1,"result":"created","_shards":{"total":2,"successful":1,"failed":0},"_seq_no":0,"_primary_term":1}

ubuntu@ip-172-31-23-72:~$ curl -X GET "http://127.0.0.1:9200/vk_movie/_doc/1"
{"_index":"vk_movie","_id":"1","_version":1,"_seq_no":0,"_primary_term":1,"found":true,"_source":{"title" : "Titanic", "genre" : "adventure", "year" : 2001}}



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Search data inside the index -----

ubuntu@ip-172-31-23-72:~$ curl -X GET "http://127.0.0.1:9200/vk_movie/_doc/1?pretty"

ubuntu@ip-172-31-23-72:~$ curl -X GET "http://localhost:9200/vk_movie/_search" -H 'Content-Type: application/json' -d'
{ "query": { "match": { "title": "Titanic" }}}'
{"took":1,"timed_out":false,"_shards":{"total":1,"successful":1,"skipped":0,"failed":0},"hits":{"total":{"value":1,"relation":"eq"},"max_score":0.2876821,"hits":[{"_index":"vk_movie","_id":"1","_score":0.2876821,"_source":{"title" : "Titanic", "genre" : "adventure", "year" : 2001}}]}}ubuntu@ip-172-31-23-72:~$

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Delete Index ----------
ubuntu@ip-172-31-23-72:~$ curl -X DELETE "http://127.0.0.1

ubuntu@ip-172-31-23-72:~$ curl -X DELETE "http://127.0.0.1:9200/vk_movie"
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------




-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Policy creation ---

curl -X PUT "http://localhost:9200/_ilm/policy/logs_policy" -H 'Content-Type: application/json' -d'
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": { "max_age": "7d", "max_size": "50gb" },
          "set_priority": { "priority": 100 }
        }
      },
      "warm": {
        "min_age": "7d",
        "actions": {
          "allocate": { "require": { "box_type": "warm" } },
          "forcemerge": { "max_num_segments": 1 },
          "shrink": { "number_of_shards": 1 },
          "set_priority": { "priority": 50 }
        }
      },
      "delete": {
        "min_age": "90d",
        "actions": { "delete": {} }
      }
    }
  }
}'

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Create Index template and attach with the policy 

ubuntu@ip-172-31-23-72:~$ curl -X PUT "http://localhost:9200/_index_template/logs_template" -H 'Content-Type: application/json' -d'
{
  "index_patterns": ["logs-*"],
  "template": {
    "settings": {
      "index.lifecycle.name": "logs_policy",
      "index.lifecycle.rollover_alias": "logs_alias"
    }
  }
}'
{"acknowledged":true}ubuntu@ip-172-31-23-72:~$


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


Create Index and attach with Index template

ubuntu@ip-172-31-23-72:~$ curl -X PUT "http://localhost:9200/logs-000001" -H 'Content-Type: application/json' -d'  {
  "aliases": {
    "logs_alias": {
      "is_write_index": true
    }
  }
}'
{"acknowledged":true,"shards_acknowledged":true,"index":"logs-000001"}ubuntu@ip-172-31-23-72:~$



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ILM Status ----
ubuntu@ip-172-31-23-72:~$ curl -X GET "http://localhost:9200/_ilm/status"

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ILM Explain----

ubuntu@ip-172-31-23-72:~$ curl -X GET "http://localhost:9200/logs-000001/_ilm/explain"
{"indices":{"logs-000001":{"index":"logs-000001","managed":true,"policy":"logs_policy","index_creation_date_millis":1761565899064,"ion":"7.27m","lifecycle_date_millis":1761565899064,"age":"7.27m","age_in_millis":436222,"phase":"hot","phase_time_millis":176156589r","action_time_millis":1761565899266,"step":"check-rollover-ready","step_time_millis":1761565899266,"phase_execution":{"policy":"linition":{"min_age":"0ms","actions":{"set_priority":{"priority":100},"rollover":{"max_age":"7d","max_primary_shard_docs":200000000,ubuntu@ip-172-31-23-72:~$

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
View Policy ----
ubuntu@ip-172-31-23-72:~$ curl -X GET    "http://localhost:9200/_ilm/policy/logs_policy"
{"logs_policy":{"version":3,"modified_date":"2025-10-27T11:46:03.950Z","policy":{"phases":{"warm":{"min_age":"7d","actions":{"forcemerge":{"max_num_segments":1},"allocate":{"include":{},"exclude":{},"require":{"box_type":"warm"}},"shrink":{"number_of_shards":1,"allow_write_after_shrink":false},"set_priority":{"priority":50}}},"hot":{"min_age":"0ms","actions":{"set_priority":{"priority":100},"rollover":{"max_age":"7d","max_size":"50gb"}}},"delete":{"min_age":"90d","actions":{"delete":{"delete_searchable_snapshot":true}}}}},"in_use_by":{"indices":["logs-000001"],"data_streams":[],"composable_templates":["logs_template"]}}}ubuntu@ip-172-31-23-72:~$
ubuntu@ip-172-31-23-72:~$
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Delete Policy -----
ubuntu@ip-172-31-23-72:~$ curl -X DELETE "http://localhost:9200/_ilm/policy/logs_policy"
{"error":{"root_cause":[{"type":"illegal_argument_exception","reason":"Cannot delete policy [logs_policy]. It is in use by one or more indices: [logs-000001]"}],"type":"illegal_argument_exception","reason":"Cannot delete policy [logs_policy]. It is in use by one or more indices: [logs-000001]"},"status":400}ubuntu@ip-172-31-23-72:~$
ubuntu@ip-172-31-23-72:~$
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------





-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Detach Policy from indexes ----

ubuntu@ip-172-31-23-72:~$ curl -X PUT "http://localhost:9200/logs-000001/_settings" -H 'Content-type:application/json'  -d'
{ "index.lifecycle.name": null,
  "index.lifecycle.rollover_alias": null }'
{"acknowledged":true}ubuntcurl -X DELETE "http://localhost:9200/_ilm/policy/logs_policy"m/policy/logs_policy"
{"acknowledged":true}ubuntu@ip-172-31-23-72:~$

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
